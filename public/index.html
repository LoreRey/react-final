<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="main.css">
    <script src="//cdn.jsdelivr.net/npm/phaser@3.3.0/dist/phaser.min.js"></script>
  </head>
  <body>

    <script>

      const gameOptions = {
        spriteSize: 40,
        gameWidth: window.innerWidth * window.devicePixelRatio,
        gameHeight: window.innerHeight * window.devicePixelRatio,
        gameSpeed: 100
      };

      window.onload = function () {
        const gameConfig = {
          type: Phaser.AUTO,
          width: gameOptions.gameWidth,
          height: gameOptions.gameHeight,
          physics: {
              default: 'arcade',
              arcade: {
                debug: true
                  // gravity: { y: 20 }
              }
          },
          scene: [playGame]
        };

        const game = new Phaser.Game(gameConfig);
        // resize();
        // window.addEventListener("resize", resize, false);
      };

      let player;
      let enemy;
      let score = 0;
      let group;

      const playGame = new Phaser.Class({
        Extends: Phaser.Scene,
        initialize:
          function playGame(){
            Phaser.Scene.call(this, {key: "PlayGame"});
          },


          preload: function () {
            this.load.image(
              "background",
              "assets/sky.png"
              );
            this.load.image(
              "pigeon",
              "assets/pigeon_ph.png",
                129,
                84
              );
            this.load.image(
              "falcon",
              "assets/images/falcon_ph.png",
                85,
                56
              );
          },



          create: function () {
            background = this.add.image(
              gameOptions.gameWidth / 2,
              gameOptions.gameHeight / 2,
              "background"
              );

            background.setScale(window.devicePixelRatio * 2);

            player = this.physics.add.sprite(
              gameOptions.gameWidth / 2,
              gameOptions.gameHeight / 2,
              "pigeon"
              );

            player.setBounce(0.4);
            player.setCollideWorldBounds(true);

            playerScore = this.add.text(100, 100, `${score}`)

            enemy = this.physics.add.sprite(
              "falcon"
              );

            enemies = this.physics.add.group({
                key: 'falcon',
                repeat: 5,
                //setcollideWorldBounds: true,
                  setXY: {
                    x: 110,
                    y: 100,
                    stepX: 600,
                    stepY: 60
                  }
                })

            cursors = this.input.keyboard.createCursorKeys();

            // this.enemies = this.add.group({
            //   key: 'falcon',
            //   repeat: 5,
            //   setXY: {
            //     x: 110,
            //     y: 100,
            //     stepX: 80,
            //     stepY: 20
            //   }

          // });

            // group = this.physics.add.group({
            //   bounceX: 1,
            //   bounceY: 1,
            //   collideWorldBounds: true
            // });

            // let enemy1 = group.create(100, 200, 'falcon').setVelocity(100, 200);
            // let enemy2 = group.create(500, 200, 'falcon').setVelocity(-100, -100);
            // let enemy3 = group.create(300, 400, 'falcon').setVelocity(60, 100);
            // let enemy4 = group.create(600, 300, 'falcon').setVelocity(-30, -50);

             // let fly = player.animations.add('right', [0,1,2,3,4,5]);


          },

          update: function () {
            let enemySpawn ;

            if (score % 100 === 0) {
              enemySpawn = enemies.create(110, 100, 'falcon')
            }

             score += 1
             playerScore.setText('score: ' + score)

            if (cursors.left.isDown) {
              player.setVelocityX(-800);
            } else if (cursors.right.isDown) {
              player.setVelocityX(800);
            // } else {
            //   player.setVelocityX(0);
            }
            if (cursors.up.isDown) {
              player.setVelocityY(-800);
            } else if (cursors.down.isDown) {
              player.setVelocityY(800);
            // } else {
            //   player.setVelocityY(0);
              // player.body.setGravity(100);
            }

            enemies.setVelocityY(300)
            enemies.setVelocityX(300)
            //enemies.speed = Math.random() * 2 + 1;





            // let group = this.group.getChildren();
            // let numEnemies = group.length;

            // for (let i = 0; i < numEnemies; i++) {
            //   group[i].y += group[i].speed;
            //   if (group[i].y >= this.groupMaxY && group[i].speed > 0) {
            //   } else if (group[i].y <= this.groupMinY && group[i].speed < 0) {
            //     group[i].speed *= -1;
            //   }
            // }

            // x
          }

        });


      // function resize() {
      //   const canvas = document.querySelector("canvas");
      //   const windowWidth = window.innerWidth;
      //   const windowHeight = window.innerHeight;
      //   const windowRatio = windowWidth / windowHeight;
      //   const gameRatio = game.config.width / game.config.height;
      //   if (windowRatio < gameRatio) {
      //       canvas.style.width = windowWidth + "px";
      //       canvas.style.height = (windowWidth / gameRatio) + "px";
      //   } else {
      //       canvas.style.width = (windowHeight * gameRatio) + "px";
      //       canvas.style.height = windowHeight + "px";
      //   }
      // }
    </script>

  </body>
</html>